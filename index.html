<html>
<header>
    <title>InglÃªs para Brasileiros</title>
</header>

<body ng-app="ipb">
    <div ng-controller="MainController">
        <div ng-view></div>
        <p>{{ test }}</p>
        <button fb-login type="button">facebook Login</button>
    </div>
    <script src="node_modules/angular/angular.min.js"></script>
    <script src="node_modules/angularjs-social-login/angularjs-social-login.js"></script>

    <script>
        var ipb = angular.module('ipb', ['socialLogin']);
        ipb.controller('MainController', ['$scope', '$rootScope', '$http', function($scope, $rootScope, $http) {
            
            var socialLoginEndpoint = "https://script.google.com/macros/s/AKfycbx2XOy1foZQM0CBR9Vh-V7DReD6IkfWZf3efxoaer3igEwnnA8/exec?";
            var action = 'login';
            
            
            $scope.test = "Test...";
            $rootScope.$on('event:social-sign-in-success', function(event, userDetails){
                console.log(userDetails);
                console.log(event);
                
                var completeUrl = socialLoginEndpoint+
                    'action='+action+
                    '&email='+userDetails.email+
                    '&name='+userDetails.name+
                    '&token='+userDetails.token+
                    '&provider='+userDetails.provider;
                
                $http({
                  method: 'GET',
                  url: completeUrl
                }).then(function successCallback(response) {
                    $scope.test = 'Thank you '+userDetails.name+' for logging in!';
                  }, function errorCallback(response) {
                    $scope.test = 'Failed';
                  });
                

            });
            
        }]);
        ipb.config(function(socialProvider) {
            //socialProvider.setGoogleKey("YOUR GOOGLE CLIENT ID");
            //socialProvider.setLinkedInKey("YOUR LINKEDIN CLIENT ID");
            socialProvider.setFbKey({
                appId: "1402554066740426",
                apiVersion: "v3.0"
            });
        });
        
    </script>
</body>

</html>
